<html>
  <head>
    <!-- Search API Setup -->
    <script>
      globalThis.addEventListener('DOMContentLoaded', () => {
        globalThis.document.querySelector('form').addEventListener('submit', async (e) => {
          e.preventDefault();

          const formData = new FormData(e.currentTarget);
          const term = formData.get('term');
          const html = await fetch('/api/search', {
            method: 'POST',
            body: new URLSearchParams({ term }).toString(),
            headers: new Headers({
              'content-type': 'application/x-www-form-urlencoded'
            })
          }).then(resp => resp.text());

          document.getElementById('search-products-output').innerHTML = html;
        });
      });
    </script>
  </head>

  <body>
    <article>
      <h2>Search API (w/ WCC)</h2>
      <p>This is an example of a Greenwood API leveraging the FormData API and returning an HTML response that is generated by server-rendering a Web Component (with Declarative Shadow DOM).  This same component is loaded on the client-side too, so that when you click the <i>Item Details</i> button, state and interactivity can still be resumed. You can see it fire in the network tab as <i>/api/search</i></p>
      <form id="search">
        <label for="term">
          <input type="search" name="term" placeholder="an product..." required/>
        </label>
        <button type="submit">Search</button>
      </form>
      <div id="search-products-output" class="products-cards-container" aria-live="polite"></div>
    </article>
  </body>
</html>
