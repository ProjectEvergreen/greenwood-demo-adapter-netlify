<html>
  <head>
    <!-- Greeting API Setup -->
    <script>
      globalThis.addEventListener('DOMContentLoaded', () => {
        globalThis.document.getElementsByTagName('form')[0].addEventListener('submit', async (e) => {
          e.preventDefault();

          const input = document.getElementsByTagName('input')[0].value;
          const data = await fetch(new URL(`/api/greeting?name=${input}`, window.location.href)).then(resp => resp.json());

          document.getElementById('greeting-output').textContent = `${data.message}! ðŸ‘‹`;
        });
      });
    </script>

    <!-- Fragment API Setup -->
    <script>
      globalThis.addEventListener('DOMContentLoaded', () => {
        const page = 5;
        let offset = 0 - page;

        globalThis.document.getElementById('load-artists').addEventListener('click', async () => {
          console.debug('load more artist card fragments!');
          offset = offset += page;
          const html = await fetch(`/api/fragment?offset=${offset}`).then(resp => resp.text());

          document.getElementById('load-artists-output').insertAdjacentHTML('beforeend', html);
        });
      });
    </script>
  </head>

  <body>
    <article>
      <h2>JSON API</h2>
      <p>This is an example of a Greenwood API Route returning JSON when fetched on-submit of the form to display a message on the page.  You can see it fire in the network tab as <i>/api/greeting</i></p>
      <form>
        <label>
          Greetings Text
          <input type="text" required/>
        </label>
        <button type="submit">Click me for a greeting!</button>
      </form>
      <h2 id="greeting-output"></h2>
    </article>
    <article>
      <h2>Fragments API (w/ WCC)</h2>
      <p>This is an example of a Greenwood API route returning an HTML response that is generated by server-rendering a Web Component (with Declarative Shadow DOM).  This same component is loaded on the client-side too, so that when you click the <i>Artist Details</i> button, state and interactivity can still be resumed. You can see it fire in the network tab as <i>/api/fragment</i></p>
      <div id="load-artists-output" class="artists-cards-contianer" aria-live="polite"></div>
      <button id="load-artists">Load More Artists</button>
    </article>
  </body>
</html>
